<!--
  Copyright 2016 Google, Inc.

  Licensed to the Apache Software Foundation (ASF) under one or more contributor
  license agreements. See the NOTICE file distributed with this work for
  additional information regarding copyright ownership. The ASF licenses this
  file to you under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


<style>

* { box-sizing:border-box; }

/* basic stylings ------------------------------------------ */
body 				 { background:url(https://scotch.io/wp-content/uploads/2014/07/61.jpg); }

h2 		 {
  text-align:center;
  margin-bottom:50px;
}
h2 small {
  font-weight:normal;
  color:#888;
  display:block;
}
.footer 	{ text-align:center; }
.footer a  { color:#53B2C8; }

/* form starting stylings ------------------------------- */
.group 			  {
  position:relative;
  margin-bottom:45px;
}
input 				{
  font-size:18px;
  padding:10px 10px 10px 5px;
  width:100%;
  border:none;
  border-bottom:1px solid #757575;
  background-color: #e7f0f9;
  font-weight:450;
}
input:focus 		{ outline:none; }

/* LABEL ======================================= */
label 				 {
  color:#999;
  font-size:18px;
  font-weight:normal;
  position:absolute;
  pointer-events:none;
  left:5px;
  top:10px;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}

/* active state */
input:focus ~ label, input:valid ~ label 		{
  top:-20px;
  font-size:14px;
  color:#3f8acd;
}

/* BOTTOM BARS ================================= */
.bar 	{ position:relative; display:block; width:100%; }
.bar:before, .bar:after 	{
  content:'';
  height:2px;
  width:0;
  bottom:1px;
  position:absolute;
  background:#3f8acd;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}
.bar:before {
  left:50%;
}
.bar:after {
  right:50%;
}

/* active state */
input:focus ~ .bar:before, input:focus ~ .bar:after {
  width:50%;
}

/* HIGHLIGHTER ================================== */
.highlight {
  position:absolute;
  height:60%;
  width:100px;
  top:25%;
  left:0;
  pointer-events:none;
  opacity:0.5;
}

/* active state */
input:focus ~ .highlight {
  -webkit-animation:inputHighlighter 0.3s ease;
  -moz-animation:inputHighlighter 0.3s ease;
  animation:inputHighlighter 0.3s ease;
}

/* ANIMATIONS ================ */
@-webkit-keyframes inputHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@-moz-keyframes inputHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@keyframes inputHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}

select 				{
  font-size:18px;
  padding:10px 10px 10px 5px;
  width:100%;
  border:none;
  border-bottom:1px solid #757575;
    background-color: #e7f0f9;
    color:#4489c8;
    font-weight: 450;

}
select:focus 		{ outline:none; }

/* LABEL ======================================= */
label 				 {
  color:#999;
  font-size:18px;
  font-weight:normal;
  position:absolute;
  pointer-events:none;
  left:5px;
  top:10px;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}

/* active state */
select:focus ~ label, select:valid ~ label 		{
  top:-20px;
  font-size:14px;
  color:#3f8acd;
}

/* BOTTOM BARS ================================= */
.bar 	{ position:relative; display:block; width:100%; }
.bar:before, .bar:after 	{
  content:'';
  height:2px;
  width:0;
  bottom:1px;
  position:absolute;
  background:#3f8acd;
  transition:0.2s ease all;
  -moz-transition:0.2s ease all;
  -webkit-transition:0.2s ease all;
}
.bar:before {
  left:50%;
}
.bar:after {
  right:50%;
}

/* active state */
select:focus ~ .bar:before, select:focus ~ .bar:after {
  width:50%;
}

/* HIGHLIGHTER ================================== */
.highlight {
  position:absolute;
  height:60%;
  width:100px;
  top:25%;
  left:0;
  pointer-events:none;
  opacity:0.5;
}

/* active state */
select:focus ~ .highlight {
  -webkit-animation:selectHighlighter 0.3s ease;
  -moz-animation:selectHighlighter 0.3s ease;
  animation:selectHighlighter 0.3s ease;
}

/* ANIMATIONS ================ */
@-webkit-keyframes selectHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@-moz-keyframes selectHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}
@keyframes selectHighlighter {
	from { background:#3f8acd; }
  to 	{ width:0; background:transparent; }
}


</style>
<button id="authorize-button" style="display: none;">Authorize</button>
<button id="signout-button" style="display: none;">Sign Out</button>
<font face="roboto">
<div style="background:#ffffff; padding:20px;">

        <form method="post" action="/editProfileCheck" name='event'>
          <div class="group">
      <input    style="color:#4489c8;"  type='text' placeholder="First Name"    name='firstName'/>
      <span class="highlight"></span>
      <span class="bar"></span>
      </div>   <div class="group">
    <input  style="color:#4489c8;" type='text' placeholder="Last Name"  name='lastName'><span class="highlight"></span>
    <span class="bar"></span>
    </div>  <span class="highlight"></span>
      <span class="bar"></span>

    <input type='text' placeholder="User Id"  name='userId' style="visibility:collapse;z-index:-5;position:fixed;">
      <div class="group"  style="background:#e7f0f9; padding:10px; font-weight:450; "> <font size="4" color="#4489c8">
        <span id="demo"  >  </span> (User id is Permanent)</font></div>

      <div class="group">
<input  style="color:#4489c8;" type='password' placeholder="Password" onclick="changePassword()" name='password'>  <span class="highlight"></span>
  <span class="bar"></span>
  </div>  <div class="group">
    <input  style="color:#4489c8;" type='password' placeholder="Retype above Password"  name='confirmPassword'><br>
    <span class="highlight"></span>
    <span class="bar"></span>
    </div>   <div class="group">
    <select name ="semester" >
  <option>Choose Semester</option>
  <option>First Semester</option>
  <option>Second Semester </option>
  <option>Third Semester</option>
  <option>Fourth Semester</option>
  <option>Fifth Semester</option>
  <option>Sixth and Above Semesters</option>
      </select><span class="highlight"></span>
      <span class="bar"></span>
      </div>   <div class="group">
  <select  name ="department" id ="department" onchange="clickDepartment()" onclick="clickDepartment()">
      <option >Choose Department</option>

  <option>Art</option>
  <option>Commerce</option>
  <option>Management</option>
  <option>Education</option>
  <option>Science</option>
  <option>Other</option>
      </select><span class="highlight"></span>
      <span class="bar"></span>
      </div>   <div class="group">


  <select name ="className"  id ="className" onclick="clickClassName()" onchange="clickClassName()">
      <option>Choose Class</option>
  </select>
  <span class="highlight"></span>
  <span class="bar"></span>
  </div>   <div class="group">
  <select name ="section" id ="section"  onclick="clickSection()" onchange="clickSection()" >
      <option>Choose Section</option>
  </select><span class="highlight"></span>
  <span class="bar"></span>
  </div>   <div class="group">
    <input  style="color:#4489c8;" type='text' placeholder="Email Address"    name='emailAddress'/><br>
    <span class="highlight"></span>
    <span class="bar"></span>
    </div>   <div class="group">
      <input  style="color:#4489c8;" type='number' placeholder="Phone No."    name='phoneNo'/><br><span class="highlight"></span>
      <span class="bar"></span>
      </div>   <div class="group">
    <font size="2" color="#4489c8">  Type your current password to confirm changes: </font>
<input  style="color:#4489c8;" type='password' placeholder="Current Password"  name='currentPassword' onpaste="return false;"/><br><span class="highlight"></span>
<span class="bar"></span>
</div>   <div class="group">
<input type='text' name='cataegoryTextName'   id='cataegoryStringText'  style="visibility:collapse;" >
<input type="button" value="Submit"  onclick="check()"  style="background: linear-gradient(0deg, #15446e, #408bce); color:#FFFFFF;"     >

            <input type="submit" value="Submit" id='hangoutButtonId'  style="visibility:collapse;"   >
        </form>
        <br><br>
      <span class="mdl-list__item-secondary-action" style="position:relative; ">

        <button  class="mdl-button mdl-js-button mdl-button--raised
                       mdl-js-ripple-effect mdl-button--colored"
                rel="editUserId" type="button" id='create'  style="position:relative;visibility:collapse;">Create</button>
                <button  class="mdl-button mdl-js-button mdl-button--raised
                               mdl-js-ripple-effect mdl-button--colored"
                        rel="getDataForUserId" type="button" id='getData'  style="position:relative;visibility:collapse;">Create</button>


</font></div>


<script>


function changePassword()
{

  document.event.confirmPassword.value = '';
}
function clickDepartment()
{


  var skillsSelect = document.getElementById("department");
  var department = skillsSelect.options[skillsSelect.selectedIndex].text;


  var classDataString = localStorage.getItem("classDataString");
  classDataString = classDataString.replace(/&quot;/g, '"');
  var classData = JSON.parse(classDataString);

  var sel = document.getElementById('className');
  // sel = skillsSelect;




function removeOptions(sel)
{
    var i;
    for(i = sel.options.length - 1 ; i >= 0 ; i--)
    {
        sel.remove(i);
    }
}


//using the function:
removeOptions(document.getElementById("className"));
removeOptions(document.getElementById("section"));

  var sectionSel = document.getElementById('section');
var opt = document.createElement('option');
opt.innerHTML = 'Choose Section';
opt.value =  'Choose Section';
sectionSel.appendChild(opt);

var opt = document.createElement('option');
opt.innerHTML = 'Choose Class';
opt.value =  'Choose Class';
sel.appendChild(opt);

  for(var i = 0; i < classData.length; i++) {


      var opt = document.createElement('option');
      var loadedUserId = localStorage.getItem("userId");
      if(classData[i].department == department)
      {

        opt.innerHTML = classData[i].className;
        opt.value = classData[i].className;
        sel.appendChild(opt);
      }

    }

}






function clickClassName()
{

  var deptName = document.getElementById("department").value;

if(!deptName.includes('Choose'))
{


  var sectionDataString = localStorage.getItem("sectionDataString");
  sectionDataString = sectionDataString.replace(/&quot;/g, '"');
  var sectionData = JSON.parse(sectionDataString);

  var skillsSelect = document.getElementById("className");
  var className = skillsSelect.options[skillsSelect.selectedIndex].text;

    var sel = document.getElementById('section');

    function removeOptions(sel)
    {
        var i;
        for(i = sel.options.length - 1 ; i >= 0 ; i--)
        {
            sel.remove(i);
        }
    }
    //using the function:
    removeOptions(document.getElementById("section"));

    var opt = document.createElement('option');
    opt.innerHTML = 'Choose Section';
    opt.value =  'Choose Section';
    sel.appendChild(opt);


    for(var i = 0; i < sectionData.length; i++) {


        var opt = document.createElement('option');
      if(sectionData[i].className == className)
      {

        opt.innerHTML = sectionData[i].section;
        opt.value = sectionData[i].section;
        sel.appendChild(opt);
      }
    }


}else{
  alert('First Choose a department');
}

}
function clickSection()
{
  var sectName = document.getElementById("className").value;

if(sectName.includes('Choose'))
{
    alert('First Choose a Class');
}

}

$('button.reset').click(
    function () {
        $(this).prevAll('input').val(function(){
            switch (this.type){
                case 'text':
                    return this.defaultValue;
                case 'checkbox':
                case 'radio':
                    this.checked = this.defaultChecked;
            }
        });
    });

</script>

<script>
var loadedFirstName = localStorage.getItem("firstName");
var loadedLastName = localStorage.getItem("lastname");
var loadedUserId = localStorage.getItem("userId");
var loadedPassword = localStorage.getItem("password");
var loadedSemester = localStorage.getItem("semester");

var loadedClassName = localStorage.getItem("className");
var loadedSection = localStorage.getItem("section");
var loadedEmailAddress = localStorage.getItem("emailAddress");
var loadedPhoneNo = localStorage.getItem("phoneNo");

 document.getElementById("demo").innerHTML = loadedUserId;



document.event.firstName.value  =   loadedFirstName;
document.event.lastName.value = loadedLastName;
document.event.userId.value = loadedUserId;
document.event.password.value = loadedPassword;
document.event.semester.value = loadedSemester;
document.event.confirmPassword.value = loadedPassword;
document.event.emailAddress.value = loadedEmailAddress;
document.event.phoneNo.value = loadedPhoneNo;
</script>

<script>








function check()
{









var firstName = document.event.firstName.value;

var lastName = document.event.lastName.value;

var userId = document.event.userId.value;

var password = document.event.password.value;

var confirmPassword = document.event.confirmPassword.value;

var semester = document.event.semester.value;

var department = document.event.department.value;

var className = document.event.className.value;

var section = document.event.section.value;

var emailAddress = document.event.emailAddress.value;

var phoneNo = document.event.phoneNo.value;

var loadedPassword = localStorage.getItem("password");

var currentPassword = document.event.currentPassword.value;














if(firstName.length < 1)
{

  alert('Enter First Name');
}
else if (lastName.length < 1) {
    alert('Enter Last Name');
}else if (userId.length < 1) {
    alert('Enter User Id');
}else if (userId.length < 6) {
    alert('Minimum size of User Id is 6 characters');
}else if (password.length < 1) {
    alert('Enter Password');
}else if (password.length < 8 ) {
    alert('Minimum size of Password is 8 Characters');
}else if(password != confirmPassword)
{
    alert('Passwords do not match ');
}else if(semester.includes('Choose'))
{
  alert('Choose a Semester');
}
else if(department.includes('Choose'))
{
  alert('Choose a Department');
}
else if(className.includes('Choose'))
{
  alert('Choose a Class');
}else if(section.includes('Choose'))
{
  alert('Choose a Section');
}else if (emailAddress.length < 1) {
    alert('Enter Email Address');
}else if (!emailAddress.includes('@')) {
    alert('Invalid Email');
}else if (!emailAddress.includes('.')) {
    alert('Invalid Email');
}else if (phoneNo.length < 10) {
    alert('Enter Valid Phone No');
}







else{
var semesterString;
  if(semester == 'First Semester')
  {
    semesterString = '1';
  }
  else if(semester == 'Second Semester')
  {
    semesterString = '2';
  }
  else if(semester == 'Third Semester')
  {
    semesterString = '3';
  }
  else if(semester == 'Fourth Semester')
  {
    semesterString = '4';
  }
  else if(semester == 'Fifth Semester')
  {
    semesterString = '5';
  }
  else if(semester == 'Sixth and Above Semesters')
  {
    semesterString = '6';
  }

  document.getElementById('cataegoryStringText').value = semesterString;

  if(loadedPassword == currentPassword)
  {

  var userId = document.event.userId.value;


//Saving Data using Html Web Storage


  if (typeof(Storage) !== "undefined") {
      // Code for localStorage/sessionStorage.

      localStorage.setItem("transferFirstName", firstName );
      localStorage.setItem("transferLastName", lastName );
      localStorage.setItem("transferUserId", userId);
      localStorage.setItem("transferPassword", password);
      localStorage.setItem("transferSemester", semester);
      localStorage.setItem("transferClassName", className);
      localStorage.setItem("transferSection", section);
      localStorage.setItem("transferEmailAddress", emailAddress);
      localStorage.setItem("transferPhoneNo", phoneNo);



      listMajors()




  } else {
      // Sorry! No Web Storage support..
        document.write('Your phone is not compatible with app');
  }



}else {
  alert('Password entered in the current password field is incorrect.')
}

}







}




</script>


<script type="text/javascript">


  // Client ID and API key from the Developer Console
  var CLIENT_ID = '494373301552-ud7mvkhosmjkbbv4th3qelqij6jatfkg.apps.googleusercontent.com';
  var API_KEY = 'AIzaSyAPAiPku7AqUy6mzyI-QVGe1cobzv8Afmw';

  // Array of API discovery doc URLs for APIs used by the quickstart
  var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

  // Authorization scopes required by the API; multiple scopes can be
  // included, separated by spaces.
  var SCOPES = "https://www.googleapis.com/auth/spreadsheets";

  var authorizeButton = document.getElementById('authorize-button');
  var signoutButton = document.getElementById('signout-button');

  /**
   *  On load, called to load the auth2 library and API client library.
   */
  function handleClientLoad() {
    gapi.load('client:auth2', initClient);
  }

  /**
   *  Initializes the API client library and sets up sign-in state
   *  listeners.
   */
  function initClient() {
    gapi.client.init({
      apiKey: API_KEY,
      clientId: CLIENT_ID,
      discoveryDocs: DISCOVERY_DOCS,
      scope: SCOPES
    }).then(function () {
      // Listen for sign-in state changes.
      gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

      // Handle the initial sign-in state.
      updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
      authorizeButton.onclick = handleAuthClick;
      signoutButton.onclick = handleSignoutClick;
    });
  }

  /**
   *  Called when the signed in status changes, to update the UI
   *  appropriately. After a sign-in, the API is called.
   */
  function updateSigninStatus(isSignedIn) {
    if (isSignedIn) {
      authorizeButton.style.display = 'none';
      signoutButton.style.display = 'block';
        listMisc('className','Class Name!A2:G','1fzxyzBACml4GPghMpplfziKPgtgfYUQYwqwVXye7usI');
    } else {
      authorizeButton.style.display = 'block';
      signoutButton.style.display = 'none';
    }
  }

  /**
   *  Sign in the user upon button click.
   */
  function handleAuthClick(event) {
    gapi.auth2.getAuthInstance().signIn();
  }

  /**
   *  Sign out the user upon button click.
   */
  function handleSignoutClick(event) {
    gapi.auth2.getAuthInstance().signOut();
  }

  /**
   * Append a pre element to the body containing the given message
   * as its text node. Used to display the results of the API call.
   *
   * @param {string} message Text to be placed in pre element.
   */
  function appendPre(message) {
    var pre = document.getElementById('content');
    var textContent = document.createTextNode(message + '\n');
    pre.appendChild(textContent);
  }

  /**
   * Print the names and majors of students in a sample spreadsheet:
   * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
   */



       var classNames = [{
              title: 'str1',
              age:   'str2'
            }];
       classNames.pop({
       title: 'str1',
       age:   'str2'
         });

         var sectionNames = [{
                title: 'str1',
                age:   'str2'
              }];
         sectionNames.pop({
         title: 'str1',
         age:   'str2'
           });


           var subjectNames = [{
                  title: 'str1',
                  age:   'str2'
                }];
           subjectNames.pop({
           title: 'str1',
           age:   'str2'
             });

             var userDetails = [{
                    title: 'str1',
                    age:   'str2'
                  }];
             userDetails.pop({
             title: 'str1',
             age:   'str2'
               });


     function listMisc(mode,rangeRetrieved,sheetIdRetrieved) {

   var rangeApplied = rangeRetrieved;
   var sheetIdApplied = sheetIdRetrieved;



       gapi.client.sheets.spreadsheets.values.get({
         spreadsheetId: sheetIdApplied,
         range: rangeApplied,
          }).then(function(response) {
            var range = response.result;
            if (range.values.length > 0) {
              for (i = 0; i < range.values.length; i++) {
                var row = range.values[i];
                // Print columns A and E, which correspond to indices 0 and 4.


                if(mode == 'className')
                {
                  var className = row[0];
                  var department = row[1];
                  classNames.push({
                    className: className,
                    department: department,
                  });

                }

               else if(mode == 'sectionName')
                {
                  var section = row[0];
                  var className = row[1];
                  sectionNames.push({
                    section: section,
                    className: className,
                  });
                }

                else if(mode == 'subjectName')
                {
                  var subject = row[0];
                  var department = row[1];
                  subjectNames.push({
                    subject: subject,
                    department: department,
                  });
                }

                else if(mode == 'userName')
                {
                  var userId =    row[0];
                  var firstName = row[2];
                  var lastname =  row[3];
                  var className = row[4];
                  var section =   row[5];
                  var emailId =   row[6];
                  var phoneNo =   row[7];
                  var semester =  row[9];

                  userDetails.push({
                    userId: userId,
                    firstName: firstName,
                    lastname: lastname,
                    className: className,
                    section: section,
                    emailId: emailId,
                    phoneNo: phoneNo,
                    semester : semester
                  });
                }



              } //End of for loop

              if(mode == 'className')
              {

                //repeats the function but with now mode= sectionName
                listMisc('sectionName','Sections!A2:G','1fzxyzBACml4GPghMpplfziKPgtgfYUQYwqwVXye7usI');

              }

             else if(mode == 'sectionName')
              {
                 //repeats the function again but with now mode= subjectName
                   listMisc('subjectName','Subjects!A2:G','1fzxyzBACml4GPghMpplfziKPgtgfYUQYwqwVXye7usI');


              }
              else if(mode == 'subjectName')
              {
                listMisc('userName','Class Data!A2:J','1On0zu6-x0qgv32KjKm4JvdtN5yYArSDfeJ4fndJvbFU');





              }else if(mode == 'userName')
              {
                var retrievedClassNames = JSON.stringify(classNames);

                var retrievedSubjectNames = JSON.stringify(subjectNames);


                var retrievedSectionNames = JSON.stringify(sectionNames);

                var retrievedUserDetails = JSON.stringify(userDetails);



                  localStorage.setItem("classDataString", retrievedClassNames);



                  localStorage.setItem("subjectDataString", retrievedSubjectNames);


                  localStorage.setItem("sectionDataString", retrievedSectionNames);

                  localStorage.setItem("userIdDataString",retrievedUserDetails)


              }








            } else {
              alert('No data found.');
            }
          }, function(response) {
            alert('Error: ' + response.result.error.message);
          });




   }

   var loadedFirstName;
   var loadedLastName;
   var loadedUserId;
   var loadedPassword;
   var loadedEmailAddress;
   var loadedPhoneNo;
   var loadedSemester;
   var loadedClassName;
   var loadedSection;



  function listMajors() {


         loadedFirstName =    localStorage.getItem("transferFirstName")
         loadedLastName =     localStorage.getItem("transferLastName")
         loadedUserId =       localStorage.getItem("transferUserId")
         loadedPassword =     localStorage.getItem("transferPassword")
         loadedEmailAddress = localStorage.getItem("transferEmailAddress")
         loadedPhoneNo =      localStorage.getItem("transferPhoneNo")
         loadedSemester =     localStorage.getItem("transferSemester")
         loadedClassName =    localStorage.getItem("transferClassName")
         loadedSection =      localStorage.getItem("transferSection")
    var a = 2;
    gapi.client.sheets.spreadsheets.values.get({
      spreadsheetId: '1On0zu6-x0qgv32KjKm4JvdtN5yYArSDfeJ4fndJvbFU',
      range: 'Class Data!A2:F',
       }).then(function(response) {
         var range = response.result;
         if (range.values.length > 0) {
           for (i = 0; i < range.values.length; i++) {
             var row = range.values[i];
             // Print columns A and E, which correspond to indices 0 and 4.

             var userIdRetrieved = row[0];

             if(loadedUserId == userIdRetrieved)
             {

               break;
             }





rangeImported =  "Class Data!".concat("A" + ++a + ":S");
           }
           if(loadedUserId == userIdRetrieved)
           {
             alert('Updating');
            updateInfo(loadedUserId,loadedPassword,loadedFirstName,loadedLastName,loadedClassName,loadedSection,loadedEmailAddress,loadedPhoneNo,'d',loadedSemester ,rangeImported);

          }
         } else {
           alert('No data found.');
         }
       }, function(response) {
         alert('Error: ' + response.result.error.message);
       });


}
function updateInfo(importedUserId,importedPassword,importedFirstName,importedLastName,importedClassName,importedSection,importedEmail,importedPhoneNo,importedInitialAttendanceStart,importedSemester,
  rangeImported)
{
     gapi.client.sheets.spreadsheets.values.update({
       spreadsheetId: '1On0zu6-x0qgv32KjKm4JvdtN5yYArSDfeJ4fndJvbFU',
       range: rangeImported,
       valueInputOption: "USER_ENTERED",
       resource:  {
                  values: [ [importedUserId,importedPassword,importedFirstName,importedLastName,importedClassName,importedSection,importedEmail,
                    importedPhoneNo,importedInitialAttendanceStart,importedSemester]]
                }
     }).then(function(response) {
       localStorage.setItem("firstName", loadedFirstName);
       localStorage.setItem("lastname", loadedLastName);
       localStorage.setItem("userId", loadedUserId);
       localStorage.setItem("password", loadedPassword);
       localStorage.setItem("semester", loadedSemester);
       localStorage.setItem("className", loadedClassName);
       localStorage.setItem("section", loadedSection);
       localStorage.setItem("emailAddress", loadedEmailAddress);
       localStorage.setItem("phoneNo", loadedPhoneNo);
      
       window.top.location.reload();
       var range = response.result;
       if (range.values.length > 0) {


       } else {
         document.write('No data found.');
       }
     }, function(response) {
       document.write('Error: ' + response.result.error.message);
     });



}


</script>

<script async defer src="https://apis.google.com/js/api.js"
  onload="this.onload=function(){};handleClientLoad()"
  onreadystatechange="if (this.readyState === 'complete') this.onload()">
</script>
