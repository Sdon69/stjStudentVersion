<!DOCTYPE html>
<html>
  <head>
    <title>Google Sheets API Quickstart</title>
    <meta charset='utf-8' />
  </head>


      <style>

      * { box-sizing:border-box; }

      /* basic stylings ------------------------------------------ */
      body 				 { background:url(https://scotch.io/wp-content/uploads/2014/07/61.jpg); }

      h2 		 {
        text-align:center;
        margin-bottom:50px;
      }
      h2 small {
        font-weight:normal;
        color:#888;
        display:block;
      }
      .footer 	{ text-align:center; }
      .footer a  { color:#53B2C8; }

      /* form starting stylings ------------------------------- */
      .group 			  {
        position:relative;
        margin-bottom:45px;
      }
      input 				{
        font-size:18px;
        padding:10px 10px 10px 5px;
        width:100%;
        border:none;
        border-bottom:1px solid #757575;

      }
      input:focus 		{ outline:none; }

      /* LABEL ======================================= */
      label 				 {
        color:#999;
        font-size:18px;
        font-weight:normal;
        position:absolute;
        pointer-events:none;
        left:5px;
        top:10px;
        transition:0.2s ease all;
        -moz-transition:0.2s ease all;
        -webkit-transition:0.2s ease all;
      }

      /* active state */
      input:focus ~ label, input:valid ~ label 		{
        top:-20px;
        font-size:14px;
        color:#3f8acd;
      }

      /* BOTTOM BARS ================================= */
      .bar 	{ position:relative; display:block; width:100%; }
      .bar:before, .bar:after 	{
        content:'';
        height:2px;
        width:0;
        bottom:1px;
        position:absolute;
        background:#3f8acd;
        transition:0.2s ease all;
        -moz-transition:0.2s ease all;
        -webkit-transition:0.2s ease all;
      }
      .bar:before {
        left:50%;
      }
      .bar:after {
        right:50%;
      }

      /* active state */
      input:focus ~ .bar:before, input:focus ~ .bar:after {
        width:50%;
      }

      /* HIGHLIGHTER ================================== */
      .highlight {
        position:absolute;
        height:60%;
        width:100px;
        top:25%;
        left:0;
        pointer-events:none;
        opacity:0.5;
      }

      /* active state */
      input:focus ~ .highlight {
        -webkit-animation:inputHighlighter 0.3s ease;
        -moz-animation:inputHighlighter 0.3s ease;
        animation:inputHighlighter 0.3s ease;
      }

      /* ANIMATIONS ================ */
      @-webkit-keyframes inputHighlighter {
      	from { background:#3f8acd; }
        to 	{ width:0; background:transparent; }
      }
      @-moz-keyframes inputHighlighter {
      	from { background:#3f8acd; }
        to 	{ width:0; background:transparent; }
      }
      @keyframes inputHighlighter {
      	from { background:#3f8acd; }
        to 	{ width:0; background:transparent; }
      }

      select 				{
        font-size:18px;
        padding:10px 10px 10px 5px;
        width:100%;
        border:none;
        border-bottom:1px solid #757575;
        -webkit-appearance: none;
      }
      select:focus 		{ outline:none; }

      /* LABEL ======================================= */
      label 				 {
        color:#999;
        font-size:18px;
        font-weight:normal;
        position:absolute;
        pointer-events:none;
        left:5px;
        top:10px;
        transition:0.2s ease all;
        -moz-transition:0.2s ease all;
        -webkit-transition:0.2s ease all;
      }

      /* active state */
      select:focus ~ label, select:valid ~ label 		{
        top:-20px;
        font-size:14px;
        color:#3f8acd;
      }

      /* BOTTOM BARS ================================= */
      .bar 	{ position:relative; display:block; width:100%; }
      .bar:before, .bar:after 	{
        content:'';
        height:2px;
        width:0;
        bottom:1px;
        position:absolute;
        background:#3f8acd;
        transition:0.2s ease all;
        -moz-transition:0.2s ease all;
        -webkit-transition:0.2s ease all;
      }
      .bar:before {
        left:50%;
      }
      .bar:after {
        right:50%;
      }

      /* active state */
      select:focus ~ .bar:before, select:focus ~ .bar:after {
        width:50%;
      }

      /* HIGHLIGHTER ================================== */
      .highlight {
        position:absolute;
        height:60%;
        width:100px;
        top:25%;
        left:0;
        pointer-events:none;
        opacity:0.5;
      }

      /* active state */
      select:focus ~ .highlight {
        -webkit-animation:selectHighlighter 0.3s ease;
        -moz-animation:selectHighlighter 0.3s ease;
        animation:selectHighlighter 0.3s ease;
      }

      /* ANIMATIONS ================ */
      @-webkit-keyframes selectHighlighter {
      	from { background:#3f8acd; }
        to 	{ width:0; background:transparent; }
      }
      @-moz-keyframes selectHighlighter {
      	from { background:#3f8acd; }
        to 	{ width:0; background:transparent; }
      }
      @keyframes selectHighlighter {
      	from { background:#3f8acd; }
        to 	{ width:0; background:transparent; }
      }


      </style>
  <body>
    <button id="authorize-button" style="display: none;">Authorize</button>
    <button id="signout-button" style="display: none;">Sign Out</button>






      <!-- Show spreadsheets -->
      <font face="roboto">
        <div id='headerDiv' style="visibility:collapse; z-index:-500; height:0px; width:0px; position:absolute;">

      <div style="width:100%; background-color:#3f8acd; padding:2%;">
          <button value='SUBMIT' onclick="clickSubmit()"  style="padding:3%; padding-right:20%; padding-left:20%; background-color:rgba(236,230,230,0.65); border:none; color:rgba(255,255,255,1.00); font-size:12px; box-shadow:rgba(0,0,0,1.00); font-weight:600; width:100%;">SUBMIT</button>


            <button value='REMOVE STUDENTS' onclick="clickRemove()" id='removeButton' style="padding:3%; margin-top:2%; padding-right:20%; padding-left:20%; background-color:rgba(236,230,230,0.65); border:none; color:rgba(255,255,255,1.00); font-size:12px; box-shadow:rgba(0,0,0,1.00); font-weight:600; width:100%;" >REMOVE STUDENT</button>
            <br><br>
              <table style="width:100%;">
                <tr><td style="font-weight:500;color:#ECE7E7;">Present : <span id='present'></span></td><td align='center' style="font-weight:500;color:#ECE7E7;">Absent : <span id='absent'></span></td><td align='right' style="font-weight:500;color:#ECE7E7;">Total:<span id='total'></span></td></table>
        </div>  </div>
      <div style="background:#ffffff; padding:20px; height:100%;" id='bodyDiv'>

            <form method="post" action="/attendanceAppendCheck" name='event'>
        <div class="form-style-2">


    </div><div class="group">
        <select name ="semester" style="background:url(black_arrow.png) no-repeat right ;" >
      <option>Choose Semester</option>
      <option>First Semester</option>
      <option>Second Semester </option>
      <option>Third Semester</option>
      <option>Fourth Semester</option>
      <option>Fifth Semester</option>
      <option>Sixth and Above Semesters</option>
          </select>
          <span class="highlight"></span>
          <span class="bar"></span>
      </div> <div class="group">
      <select  name ="department" id ="department"  style="background:url(black_arrow.png) no-repeat right ;" onchange="clickDepartment()" onclick="clickDepartment()">
          <option >Choose Department</option>

      <option>Art</option>
      <option>Commerce</option>
      <option>Management</option>
      <option>Education</option>
      <option>Science</option>
      <option>Other</option>
          </select>

        </select>
        <span class="highlight"></span>
        <span class="bar"></span>
      </div> <div class="group">
      <select name ="className"  id ="className" style="background:url(black_arrow.png) no-repeat right ;" onclick="clickClassName()" onchange="clickClassName()">
          <option>Choose Class</option>
      </select>
    </select>
    <span class="highlight"></span>
    <span class="bar"></span>
    </div> <div class="group">
      <select name ="section" id ="section"  style="background:url(black_arrow.png) no-repeat right ;"  onclick="clickSection()" onchange="clickSection()" >
          <option>Choose Section</option>
      </select>
        <span class="highlight"></span>
        <span class="bar"></span>
    </div>
    <div class="group">
      <select name ="subject" id ="subject"   style="background:url(black_arrow.png) no-repeat right ;" onclick="clickSubject()" onchange="clickSection()" >
          <option>Choose Subject</option>
      </select>
        <span class="highlight"></span>
        <span class="bar"></span>
    </div>
    </div>


    <input type='text' name='cataegoryTextName' value='false'  id='cataegoryStringText'  style="visibility:collapse; height:0px;" >
    <input type='text' name='todayTextName' value='false'  id='todayDateText'   style="visibility:collapse;height:0px;" >
    <input type="button" value="Submit"  onclick="check()"  style="background: linear-gradient(0deg, #15446e, #408bce); color:#FFFFFF;"    >

                <input type="submit" value="Submit" id='hangoutButtonId'  style="visibility:collapse;"   >
              </div>
            </form>
            <br><br>
          <span class="mdl-list__item-secondary-action" style="position:relative; ">

            <button  class="mdl-button mdl-js-button mdl-button--raised
                           mdl-js-ripple-effect mdl-button--colored"
                    rel="appendAttendance" type="button" id='create'  style="position:relative;visibility:collapse;">Create</button>
                    <button  class="mdl-button mdl-js-button mdl-button--raised
                                   mdl-js-ripple-effect mdl-button--colored"
                            rel="getDataForUserId" type="button" id='getData'  style="position:relative;visibility:collapse;">Create</button>

    </div></font>



    <script>



      var delayInMilliseconds = 2000; //1 second

      setTimeout(function() {

        document.getElementById('getData').click();
      }, delayInMilliseconds);

    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/json2html/1.0.0/json2html.min.js"></script>
    <script>
    var cataegoryString;
    var presentUser = [{
      user: 'user'
    }];


    var studentsPresent = 0;

    selectedButtonInfo = [{
      user:'user',
      name:'name'
    }];

    selectedButtonInfo.pop({
      user:'user',
      name:'name'
    });
    presentUser.pop({
      user: 'user'
    });


    var mode = 'remove';

    var subject;
    function clickDepartment()
    {


      var skillsSelect = document.getElementById("department");
      var department = skillsSelect.options[skillsSelect.selectedIndex].text;


      var classDataString = localStorage.getItem("classDataString") ;
      classDataString = classDataString.replace(/&quot;/g, '"');
      var classData = JSON.parse(classDataString);

      var subjectDataString = localStorage.getItem("subjectDataString") ;
      subjectDataString = subjectDataString.replace(/&quot;/g, '"');
      var subjectData = JSON.parse(subjectDataString);

      var sel = document.getElementById('className');
        var subjectSel = document.getElementById('subject');
      // sel = skillsSelect;




    function removeOptions(sel)
    {
        var i;
        for(i = sel.options.length - 1 ; i >= 0 ; i--)
        {
            sel.remove(i);
        }
    }


    //using the function:
    removeOptions(document.getElementById("className"));
    removeOptions(document.getElementById("section"));
    removeOptions(document.getElementById("subject"));

      var sectionSel = document.getElementById('section');
    var opt = document.createElement('option');
    opt.innerHTML = 'Choose Section';
    opt.value =  'Choose Section';
    sectionSel.appendChild(opt);

    var opt = document.createElement('option');
    opt.innerHTML = 'Choose Class';
    opt.value =  'Choose Class';
    sel.appendChild(opt);

    var opt = document.createElement('option');
    opt.innerHTML = 'Choose Subject';
    opt.value =  'Choose Subject';
    subjectSel.appendChild(opt);

      for(var i = 0; i < classData.length; i++) {


          var opt = document.createElement('option');

          if(classData[i].department == department)
          {

            opt.innerHTML = classData[i].className;
            opt.value = classData[i].className;
            sel.appendChild(opt);

          }

        }

        for(var i = 0; i < subjectData.length; i++) {


            var optSubject = document.createElement('option');

            if(subjectData[i].department == department)
            {

              optSubject.innerHTML = subjectData[i].subject;
              optSubject.value = subjectData[i].subject;
              subjectSel.appendChild(optSubject);
            }

          }

    }





    function clickClassName()
    {

      var deptName = document.getElementById("department").value;

    if(!deptName.includes('Choose'))
    {


      var sectionDataString = localStorage.getItem("sectionDataString");
      sectionDataString = sectionDataString.replace(/&quot;/g, '"');
      var sectionData = JSON.parse(sectionDataString);

      var skillsSelect = document.getElementById("className");
      var className = skillsSelect.options[skillsSelect.selectedIndex].text;

        var sel = document.getElementById('section');

        function removeOptions(sel)
        {
            var i;
            for(i = sel.options.length - 1 ; i >= 0 ; i--)
            {
                sel.remove(i);
            }
        }
        //using the function:
        removeOptions(document.getElementById("section"));

        var opt = document.createElement('option');
        opt.innerHTML = 'Choose Section';
        opt.value =  'Choose Section';
        sel.appendChild(opt);


        for(var i = 0; i < sectionData.length; i++) {


            var opt = document.createElement('option');
          if(sectionData[i].className == className)
          {

            opt.innerHTML = sectionData[i].section;
            opt.value = sectionData[i].section;
            sel.appendChild(opt);
          }
        }


    }else{
      alert('First Choose a department');
    }

    }
    function clickSection()
    {
      var sectName = document.getElementById("className").value;

    if(sectName.includes('Choose'))
    {
        alert('First Choose a Class');
    }

    }

    function clickSubject()
    {
      var deptName = document.getElementById("department").value;

    if(deptName.includes('Choose'))
    {
        alert('First Choose a Department');
    }

    }

    $('button.reset').click(
        function () {
            $(this).prevAll('input').val(function(){
                switch (this.type){
                    case 'text':
                        return this.defaultValue;
                    case 'checkbox':
                    case 'radio':
                        this.checked = this.defaultChecked;
                }
            });
        });






        function clickSubmit()
        {
          var today = new Date();
          var dd = today.getDate();
          var mm = today.getMonth()+1; //January is 0!

          var yyyy = today.getFullYear();
          if(dd<10){
          dd='0'+dd;
          }
          if(mm<10){
          mm='0'+mm;
          }
        var monthName;
          if(mm == 1)
          {
            monthName = 'Jan';
          }else if(mm == 2)
          {
            monthName = 'Feb';
          }else if(mm == 3)
          {
            monthName = 'Mar';
          }else if(mm == 4)
          {
            monthName = 'Apr';
          }else if(mm == 5)
          {
            monthName = 'May';
          }else if(mm == 6)
          {
            monthName = 'June';
          }else if(mm == 7)
          {
            monthName = 'July';
          }else if(mm == 8)
          {
            monthName = 'Aug';
          }else if(mm == 9)
          {
            monthName = 'Sep';
          }else if(mm == 10)
          {
            monthName = 'Oct';
          }else if(mm == 11)
          {
            monthName = 'Nov';
          }else if(mm == 12)
          {
            monthName = 'Dec';
          }

          var today = dd+monthName+yyyy+subject;

          alert(today);






            document.getElementById('cataegoryStringText').value = JSON.stringify(presentUser);

            var studentsPresentTotal = JSON.stringify(selectedButtonInfo);
            alert(studentsPresentTotal);
                localStorage.setItem("studentsPresentTotal", studentsPresentTotal);
                localStorage.setItem("attendanceDate", today);









          document.getElementById('todayDateText').value = today;



            document.getElementById('absent').innerHTML = parseInt(document.getElementById('total').innerHTML) -   parseInt(document.getElementById('present').innerHTML);

            listMajors();
               // document.getElementById('hangoutButtonId').click();
               //
               // var delayInMilliseconds = 10; //0.01 second
               //
               // setTimeout(function() {
               //
               //   document.getElementById('create').click();
               //        window.location.href = "/attendance";
               // }, delayInMilliseconds);


        }
        function check()
        {










        var semester = document.event.semester.value;

        var department = document.event.department.value;

        var className = document.event.className.value;

        var section = document.event.section.value;

        subject = document.event.subject.value;


        localStorage.setItem("classNameSelected", className);
        localStorage.setItem("sectionSelected",section);














        if(semester.includes('Choose'))
        {
          alert('Choose a Semester');
        }
        else if(department.includes('Choose'))
        {
          alert('Choose a Department');
        }
        else if(className.includes('Choose'))
        {
          alert('Choose a Class');
        }else if(section.includes('Choose'))
        {
          alert('Choose a Section');
        }else if(subject.includes('Choose'))
        {
          alert('Choose a Subject');
        }






        else{
        var semesterString;
          if(semester == 'First Semester')
          {
            semesterString = '1';
          }
          else if(semester == 'Second Semester')
          {
            semesterString = '2';
          }
          else if(semester == 'Third Semester')
          {
            semesterString = '3';
          }
          else if(semester == 'Fourth Semester')
          {
            semesterString = '4';
          }
          else if(semester == 'Fifth Semester')
          {
            semesterString = '5';
          }
          else if(semester == 'Sixth and Above Semesters')
          {
            semesterString = '6';
          }


  localStorage.setItem("semesterSelected",semesterString);
          var used = false;

          var userIdDataString = localStorage.getItem("userIdDataString")
          userIdDataString = userIdDataString.replace(/&quot;/g, '"');
          var userIdData = JSON.parse(userIdDataString);



        userIdInfo = [{
          name : 'someName',
          userId: 'someUserId'
        }]
          for(i = 0;i<userIdData.length;i++)
          {


            if(userIdData[i].className == className)
            {

              if(userIdData[i].section == section)
              {

                if(userIdData[i].semester == semesterString)
                {

                var firstName =   userIdData[i].firstName;

                var lastName = userIdData[i].lastname;

                var fullName = `${firstName} ${lastName}`;

                var userId = userIdData[i].userId;


                if(!used)
                {
                userIdInfo.pop({
                  name : 'someName',
                  userId: 'someUserId'
                });
                userIdInfo.push({
                  name : fullName,
                  userId: userId,
                  rowNumber:i
                });
                used = true;
              }else
              {
                userIdInfo.push({
                  name : fullName,
                  userId: userId,
                  rowNumber:i
                });
              }

                }
              }

            }

          }





                       var t = {'<>':"div id='${userId},${name},${rowNumber}div' style='width:100%;padding-top:20px;'",'html':[

                                               {'<>':"button id='${userId},${name},${rowNumber}' name='1' value='user${userId}' onClick='reply_click(this.id)'  style='background:#fff;color:#3f8acd;width:100%; ",'html':[
                                                 {'<>':"font face='Roboto'",'html':[
                                                       {'<>':"div style='width:100%; padding-bottom:10px; margin-right:20px; padding-left:2%; background:#ffffff;'",'children':[
                                               {
                                                 '<>':"div style='width:100%'",'children':[
                                                   {
                                                  '<>':"table style='width:100%'",'children':[
                                                       {
                                                           '<>':"tr",'children':[
                                                             {
                                                             '<>':"td style='margin-bottom:3px; color:#3f8acd;font-size:14px; font-weight:600; padding-top:25px;text-align:left;'",'html':"${name}"
                                                             }

                                                           ]
                                                       }
                                                     ]
                                                   }
                                                 ]
                                               },{
                                                  '<>':"div style='font-size:12px; font-weight:450; padding-top:5px;text-align: left;color:#000000;'",'html':"${userId}"
                                               }
                                           ]}  ] }]}]};


            var d = userIdInfo;

            var transformedHtml =  json2html.transform(d,t) ;

          document.getElementById("bodyDiv").innerHTML=transformedHtml;

            document.getElementById("headerDiv").style="width:100%;padding:1%; background-color:#3f8acd;";

            document.getElementById('total').innerHTML = userIdInfo.length;




        }







        }


        function reply_click(clicked_id)
        {





            var clickedButton = document.getElementById(clicked_id);
              var clickedDiv = document.getElementById(clicked_id +'div');
            clickedButton.style = "visibility:collapse; z-index:-500; height:0px; width:0px; position:absolute;";
            clickedDiv.style = "width:100%;"; //removed padding

            var buttonInfo = clicked_id.split(",");

            var num = parseInt(buttonInfo[2]) + 2;
            var rowNumberString = num.toString();


            selectedButtonInfo.push({
              name :  buttonInfo[1],
              userId: buttonInfo[0],
              rowNumber : rowNumberString
            });




            for(i=0; i<userIdInfo.length;i++ )
            {

              if(userIdInfo[i].userId == buttonInfo[0] )
              {
                var index = i;
                break;
              }
            }


        if (index > -1) {
            userIdInfo.splice(index, 1);
        }

             document.getElementById('present').innerHTML = ++studentsPresent;

        }


        // Check from here



        function remove_reply_click(clicked_id)
        {


            var clickedButton = document.getElementById(clicked_id);
              var clickedDiv = document.getElementById(clicked_id +'div');
            clickedButton.style = "visibility:collapse; z-index:-500; height:0px; width:0px; position:absolute;";
            clickedDiv.style = "width:100%;"; //removed padding

            var buttonInfo = clicked_id.split(",");




            userIdInfo.push({
              name :  buttonInfo[1].replace("remove", ""),
              userId: buttonInfo[0].replace("remove", "")
            });



            var editedButtonInfo = buttonInfo[0].replace("remove", "");
            for(i=0; i<selectedButtonInfo.length;i++ )
          {

            if(selectedButtonInfo[i].userId == editedButtonInfo )
            {
              var index = i;
              break;
            }
          }

        ;
        if (index > -1) {
          selectedButtonInfo.splice(index, 1);
        }

        for(i=0; i<presentUser.length;i++ )
        {

          if(presentUser[i].userId == editedButtonInfo )
          {
            var index = i;
            break;
          }
        }


        if (index > -1) {
        presentUser.splice(index, 1);
        }


             document.getElementById('present').innerHTML = --studentsPresent;


        }

        function clickRemove()
        {

        if(mode == 'remove')
        {
                         var t = {'<>':"div id='remove${userId},${name}div' style='width:100%;padding-top:20px;'",'html':[

                                                 {'<>':"button id='remove${userId},${name}' name='1' value='user${userId}' onClick='remove_reply_click(this.id)'  style='background:#fff;color:#3f8acd;width:100%; ",'html':[
                                                   {'<>':"font face='Roboto'",'html':[
                                                         {'<>':"div style='width:100%; padding-bottom:10px; margin-right:20px; padding-left:2%; background:#ffffff;'",'children':[
                                                 {
                                                   '<>':"div style='width:100%'",'children':[
                                                     {
                                                    '<>':"table style='width:100%'",'children':[
                                                         {
                                                             '<>':"tr",'children':[
                                                               {
                                                               '<>':"td style='margin-bottom:3px; color:#3f8acd;font-size:14px; font-weight:600; padding-top:25px;text-align:left;'",'html':"${name}"
                                                               }

                                                             ]
                                                         }
                                                       ]
                                                     }
                                                   ]
                                                 },{
                                                    '<>':"div style='font-size:12px; font-weight:450; padding-top:5px;text-align: left;color:#000000;'",'html':"${userId}"
                                                 }
                                             ]}  ] }]}]};


              var d = selectedButtonInfo;

              var transformedHtml =  json2html.transform(d,t) ;

            document.getElementById("bodyDiv").innerHTML=transformedHtml;

            mode = 'add';
            document.getElementById("removeButton").innerHTML='ADD STUDENT';

          }else if(mode == 'add')
          {
            var t = {'<>':"div id='${userId},${name}div' style='width:100%;padding-top:20px;'",'html':[

                                    {'<>':"button id='${userId},${name}' name='1' value='user${userId}' onClick='reply_click(this.id)'  style='background:#fff;color:#3f8acd;width:100%; ",'html':[
                                      {'<>':"font face='Roboto'",'html':[
                                            {'<>':"div style='width:100%; padding-bottom:10px; margin-right:20px; padding-left:2%; background:#ffffff;'",'children':[
                                    {
                                      '<>':"div style='width:100%'",'children':[
                                        {
                                       '<>':"table style='width:100%'",'children':[
                                            {
                                                '<>':"tr",'children':[
                                                  {
                                                  '<>':"td style='margin-bottom:3px; color:#3f8acd;font-size:14px; font-weight:600; padding-top:25px;text-align:left;'",'html':"${name}"
                                                  }

                                                ]
                                            }
                                          ]
                                        }
                                      ]
                                    },{
                                       '<>':"div style='font-size:12px; font-weight:450; padding-top:5px;text-align: left;color:#000000;'",'html':"${userId}"
                                    }
                                ]}  ] }]}]};


        var d = userIdInfo;

        var transformedHtml =  json2html.transform(d,t) ;

        document.getElementById("bodyDiv").innerHTML=transformedHtml;
            mode = 'remove';
                  document.getElementById("removeButton").innerHTML='REMOVE STUDENT';

          }
        }

    </script>


    <script type="text/javascript">

      var inputRes;
      var includes;
      var canBeExecuted = false;

      var readInfo = [{
        dataToBeWritten: 'd',
        rowNumber : 0
      }];
      readInfo.pop({
        dataToBeWritten: 'd',
        rowNumber : 0
      });
      // Client ID and API key from the Developer Console
      var CLIENT_ID = '440184094540-ee1jb05ecrbgmicqcpqjk9v8s1cmqo8p.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyA_zPUSHHB4qZHu7BiB8Tyh0bUdemAe_Gg';

      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = "https://www.googleapis.com/auth/spreadsheets";

      var authorizeButton = document.getElementById('authorize-button');
      var signoutButton = document.getElementById('signout-button');

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
          // Listen for sign-in state changes.
          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

          // Handle the initial sign-in state.
          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
          authorizeButton.onclick = handleAuthClick;
          signoutButton.onclick = handleSignoutClick;
        });
      }

      /**
       *  Called when the signed in status changes, to update the UI
       *  appropriately. After a sign-in, the API is called.
       */
      function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
          authorizeButton.style.display = 'none';
          signoutButton.style.display = 'block';
          // listMajors();
        } else {
          authorizeButton.style.display = 'block';
          signoutButton.style.display = 'none';
        }
      }

      /**
       *  Sign in the user upon button click.
       */
      function handleAuthClick(event) {
        gapi.auth2.getAuthInstance().signIn();
      }

      /**
       *  Sign out the user upon button click.
       */
      function handleSignoutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node. Used to display the results of the API call.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('content');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }

      /**
       * Print the names and majors of students in a sample spreadsheet:
       * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
       */


      function listMajors() {
        var totalPresentUsers = localStorage.getItem("studentsPresentTotal");
        var attendanceDate = localStorage.getItem("attendanceDate");
        var classNameSelected = localStorage.getItem("classNameSelected");
        var sectionSelected = localStorage.getItem("sectionSelected");
        var semesterSelected = localStorage.getItem("semesterSelected");
        totalPresentUsersString = totalPresentUsers.replace(/&quot;/g, '"');
        var totalPresentUsersData = JSON.parse(totalPresentUsersString);
        var a = 1;
        var rangeImported = "Class Data!".concat("I"+ ++a + ":S");
        var existingDateArrObj = [{
        data:'row[0]',
        rowNumber:'0'
      }];
      existingDateArrObj.pop({
        data:'row[0]',
        rowNumber:'0'
      });



        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1On0zu6-x0qgv32KjKm4JvdtN5yYArSDfeJ4fndJvbFU',
          range: 'Class Data!A2:J',
           }).then(function(response) {
             var range = response.result;
             if (range.values.length > 0) {
               for (i = 0; i < range.values.length; i++) {
                 var row = range.values[i];
                 // Print columns A and E, which correspond to indices 0 and 4.





                 className = row[4];


                  if(className == classNameSelected)
                  {
                        var section = row[5];
                    if(section == sectionSelected)
                    {
                      var semester = row[9]
                      if(semester == semesterSelected)
                      {



                                    for(k=0; k <= totalPresentUsersData.length;k++ )
                                    {

                                      if(totalPresentUsersData[k].userId == row[0] )
                                      {
                                        var existingDate = row[8];
                                          var   appendedDate = existingDate + attendanceDate ;
                                          updateInfo(appendedDate,rangeImported);
                                        break;
                                      }
                                    }



              }
            }
          }

rangeImported =  "Class Data!".concat("I" + ++a + ":S");
               }

             } else {
               alert('No data found.');
             }
           }, function(response) {
             alert('Error: ' + response.result.error.message);
           });


}
function updateInfo(stringImported,rangeImported)
{
         gapi.client.sheets.spreadsheets.values.update({
           spreadsheetId: '1On0zu6-x0qgv32KjKm4JvdtN5yYArSDfeJ4fndJvbFU',
           range: rangeImported,
           valueInputOption: "USER_ENTERED",
           resource:  {
                      values: [ [stringImported]]
                    }
         }).then(function(response) {

           var range = response.result;
           if (range.values.length > 0) {


           } else {
             document.write('No data found.');
           }
         }, function(response) {
           document.write('Error: ' + response.result.error.message);
         });



}


    </script>



    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
  </body>
</html>
